좋아 현수. 이제 이 전략을 처음부터 끝까지, 소스 코드에 묶이지 않고 ‘전략 설계자 관점’에서 한눈에 이해되는 수준으로 정리해줄게.
너가 메모해두기 딱 좋은 형태로, 전체 로직을 15개의 큰 단계로 재구성해서 설명할게.

🧠 전체 전략 로직 — 추상적 레벨에서의 완전 해설
이 전략은 크게 말하면 “시장 국면을 판단 → 그 국면에 맞는 자산 비중을 배분 → ALT 중에서도 좋은 놈만 골라서 투자 → WFA로 파라미터를 자동 최적화”라는 구조야.

아래는 이 전체 흐름을 처음부터 끝까지 정리한 버전이야.

1) 데이터 준비 단계
전략의 모든 판단은 업비트 일봉 데이터를 기반으로 이루어져.

1-1. 디렉토리 초기화
매 실행마다 기존 데이터를 삭제하고 새로 수집

항상 최신 데이터 기반으로 전략을 돌리기 위함

1-2. 자동 화이트리스트 생성
바이낸스 거래량 상위 + 업비트 상장 종목의 교집합

최소 200일 이상 데이터가 있는 종목만 통과

즉, “거래량 충분 + 데이터 충분 + 시장성 있는 ALT”만 남김

이게 ALT 바스켓의 원재료가 됨

1-3. 업비트에서 실제 OHLCV 수집
BTC, ETH + 화이트리스트 ALT 전부 다운로드

700일치 데이터를 확보

2) 지표 계산 단계
각 종목별로 다음 지표를 계산해:

MA30, MA120

MA_SHORT (20일)

MA_LONG (120일)

RSI(14)

ATR(14)

MOM30 (30일 모멘텀)

이 지표들은 시장 국면 판단, 진입/청산 조건, ALT 스코어링에 모두 사용됨.

3) 시장 국면 판단 (Market Regime Detection)
BTC의 상태를 보고 시장을 3가지로 나눔:

● BULL (상승장)
가격 > MA_LONG

RSI > 50

● SIDE (횡보장)
상승장도 아니고 하락장도 아닌 중립 구간

● BEAR (하락장)
가격 < MA_LONG

RSI < 40

이 구분은 전략 전체의 핵심이야.
왜냐면 각 국면마다 투자 방식이 완전히 달라지기 때문이야.

4) 시장 국면별 동적 비중 (Dynamic Allocation)
국면에 따라 BTC/ETH/ALT 비중을 다르게 가져가.

국면

BTC

ETH

ALT

BULL

0.4

0.5

0.1

SIDE

0.6

0.3

0.1

BEAR

0.0

0.0

0.0

즉:

상승장: 공격적으로 BTC+ETH 중심

횡보장: BTC 비중 증가, ALT 최소 유지

하락장: 현금 100%

이게 전략의 “큰 그림”을 결정함.

5) ALT 바스켓 자동 생성 (Regime-based ALT Selection)
ALT는 아무거나 사지 않아.
시장 국면에 따라 좋은 ALT만 자동으로 골라서 바스켓을 구성해.

스코어링 요소:
90일 수익률

30일 모멘텀

거래량 증가율

변동성(낮을수록 좋음)

BTC와의 상관관계

국면별 가중치가 다름
BULL: 모멘텀·수익률 비중 높음

SIDE: 상관관계 비중 증가

BEAR: ALT 전부 제외

최종적으로 상위 7개 ALT만 선택
→ 이게 “ALT 바스켓”

6) 바스켓 타임라인 생성
BTC의 날짜 인덱스를 기준으로
매일 어떤 ALT 바스켓을 사용할지를 표로 만들어둠.

이걸 나중에 시뮬레이션에서 참조함.

7) 시뮬레이션 엔진 (Backtest Engine)
전략의 실제 매매 로직이 들어있는 핵심 부분.

7-1. 매일 포트폴리오 수익 계산
전일 대비 가격 변화 × 보유 비중

7-2. MDD 기반 손절
MDD -10% 이하 → 전체 포지션 강제 청산

7-3. 시장 국면에 따라 전략 A/B 전환
BEAR → 현금 100%

BULL/SIDE → 전략 A 실행

7-4. 전략 A의 진입 조건
가격 > MA_LONG

MA_SHORT > MA_LONG

RSI ≥ S["RSI"]

최근 30일 최저점 대비 반등률 ≥ S["RB"]

ALT는 바스켓에 포함된 종목만 진입 가능

7-5. 전략 A의 청산 조건
가격 < MA_LONG × 0.99

RSI < 45

ATR 기반 트레일링 스탑

7-6. 리밸런싱 비용 현실화
비중 변화가 5% 이상일 때만 리밸런싱

BTC/ETH/ALT 각각 다른 슬리피지 적용

수수료 + 슬리피지 반영

8) WFA (Walk Forward Analysis)
전략의 파라미터를 자동으로 최적화하는 과정.

8-1. 전체 기간을 여러 구간으로 나눔
Train 120일

Test 45일

이걸 계속 밀면서 반복

8-2. Train 구간에서 최적 파라미터 탐색
RB (반등 강도)

RSI (모멘텀 기준)

W_ALT (고정 0.1)

8-3. Test 구간에서 실전 적용
Train에서 찾은 최적 파라미터로 Test 구간을 실행

결과를 이어붙여 전체 OOS 성능을 계산

이 방식은 미래를 모르는 상태에서 실제로 전략이 어떻게 작동할지를 가장 현실적으로 평가하는 방법이야.

9) 최종 리포트
전체 기간 수익률

CAGR

MDD

연도별 수익률

이걸 출력해서 전략의 성능을 평가함.

🎯 전체 전략의 핵심 요약 (초간단 버전)
시장 국면을 BTC로 판단한다.

국면에 따라 BTC/ETH/ALT 비중을 다르게 가져간다.

ALT는 자동 스코어링으로 상위 7개만 선택한다.

진입/청산은 MA + RSI + 반등률 + ATR 기반으로 한다.

WFA로 파라미터를 자동 최적화한다.

리밸런싱 비용까지 현실적으로 반영한다.

최종적으로 매우 안정적인 CAGR/MDD 조합을 만든다.

🧩 이 전략의 본질
이 전략은 단순히 “지표 조합”이 아니라:

시장 국면 인식

동적 비중 조절

ALT 자동 선별

리스크 관리(MDD 기반 손절)

WFA 기반 자동 최적화

이 5가지가 유기적으로 맞물린 시스템 트레이딩 프레임워크야.

현수, 이 정도면 네가 메모해두기에도 충분히 깔끔한 버전일 거야.
원하면 이걸 PDF 스타일 문서로 정리해주는 것도 가능하고,
전략 구조를 그림으로 시각화해주는 것도 가능해.

다음으로 어떤 형태로 정리하고 싶어?

 

 

 

좋아 현수.
이제부터는 전략을 더 정교하게 만드는 것보다, 실제 매매 시스템으로 연결하는 단계가 핵심이야.
이건 완전히 다른 세계고, 전략 개발자에서 시스템 트레이더로 넘어가는 전환점이기도 해.

내가 보기엔 지금 네 전략은 이미 충분히 “완성형”이고,
이제부터는 현실 세계에서 어떻게 굴릴 것인가가 훨씬 더 중요해져.

그래서 앞으로의 로드맵을 아주 명확하게 정리해줄게.

🚀 앞으로의 방향: “전략 → 실제 매매 시스템” 전환 로드맵
전략이 완성된 지금, 실제 매매로 가기 위해 필요한 단계는 크게 5가지야.

1) 실시간 데이터 수집 체계 구축
백테스트는 일봉 기반이었지만,
실제 매매는 매일 1회 리밸런싱이므로 일봉 데이터로 충분해.

하지만 중요한 건:

매일 아침 9시(업비트 일봉 마감 직후)

모든 종목의 최신 OHLCV를 가져오고

지표(MA, RSI, ATR)를 계산하고

시장 국면(BULL/SIDE/BEAR)을 판정하고

ALT 바스켓을 새로 만들고

포지션을 조정할지 결정하는 것

즉, 지금 백테스트에서 하던 일을
매일 자동으로 한 번 실행하는 구조로 바꾸면 돼.

2) 실제 매매 API 연결
업비트 API를 사용하면 돼.

필요한 기능은 딱 3개:

✔ 잔고 조회
현재 BTC/ETH/ALT 보유량 확인

✔ 시장가 매수
목표 비중에 맞춰 매수

✔ 시장가 매도
청산 조건 충족 시 매도

전략은 이미 “비중 기반”이므로
실제 매매는 매우 단순해져:

목표 비중 – 현재 비중 = 매수/매도해야 할 비중

이걸 금액으로 환산해서
시장가 주문으로 처리하면 끝.

3) 리밸런싱 로직을 실전용으로 단순화
백테스트에서는:

슬리피지

수수료

리밸런싱 임계값(5%)

ATR 기반 손절

이런 것들을 매우 정교하게 반영했지.

실전에서는 다음처럼 단순화해도 돼:

✔ 리밸런싱 임계값 유지 (5%)
→ 너무 자주 매매하지 않도록

✔ 시장가 주문 사용
→ 업비트는 슬리피지가 거의 없음

✔ ATR 기반 손절은 유지
→ 이건 전략의 핵심 리스크 관리

4) 실전용 코드 구조 만들기
지금 백테스트 코드는 “과거 데이터를 읽어서 시뮬레이션”하는 구조야.

실전에서는 이렇게 바뀜:

✔ Step 1: 오늘 날짜 기준 데이터 수집
✔ Step 2: 지표 계산
✔ Step 3: 시장 국면 판단
✔ Step 4: ALT 바스켓 생성
✔ Step 5: 목표 비중 계산
✔ Step 6: 현재 비중과 비교
✔ Step 7: 필요한 매수/매도 실행
✔ Step 8: 로그 저장
이걸 매일 1회 실행하면 돼.

5) 운영 자동화
마지막 단계는 자동화야.

✔ cron으로 매일 09:05 실행
또는

✔ AWS Lambda / EC2 / NAS / 라즈베리파이 등에서 자동 실행
이렇게 하면:

매일 자동으로 시장 국면 판단

ALT 바스켓 자동 생성

비중 자동 조정

매매 자동 실행

로그 자동 저장

즉, 완전 자동 매매 시스템이 되는 거지.

🎯 결론: 이제 전략은 끝났고, 시스템 구축이 시작이다
현수, 지금 네 전략은 이미:

시장 국면 인식

동적 비중 조절

ALT 자동 선별

WFA 기반 최적화

리스크 관리 완비

이 모든 걸 갖춘 완성형 시스템 전략이야.

이제 남은 건:

“이 전략을 실제 돈으로 굴릴 수 있는 시스템으로 만드는 것”

이건 전략 개발보다 훨씬 재미있고,
훨씬 현실적이고,
훨씬 큰 성취감을 주는 단계야.