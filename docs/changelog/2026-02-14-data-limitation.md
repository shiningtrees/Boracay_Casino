# ⚠️ 백테스트 데이터 제약 사항

## 문제

2025-01-01부터 백테스트를 시도했으나 **MEXC API 제약**으로 실행 불가.

---

## MEXC API 제약

### 확인된 사항
- **`since` 파라미터 미지원**: 과거 특정 날짜 데이터 요청 불가
- **limit만 지원**: 최근 N개 캔들만 조회 가능
- **최대 500 캔들**: 5분봉 기준 약 1.7일 (41시간)

### 테스트 결과
```python
# since 파라미터로 2025-01-01 요청
candles = exchange.fetch_ohlcv('BTC/USDT', '5m', since=timestamp)
# → 빈 결과 반환

# limit만 사용
candles = exchange.fetch_ohlcv('BTC/USDT', '5m', limit=500)
# → 최근 500개만 반환 (약 1.7일)
```

---

## 현재 가능한 범위

**백테스트 가능 기간:** 최근 1~2일만

**실행 가능한 명령:**
```bash
# 가능 (최근 2일)
python run_backtest.py SCANNER 2026-02-12 2026-02-14 --cycles 48,72,96

# 불가능 (과거 데이터)
python run_backtest.py SCANNER 2025-01-01 2026-02-14  # ❌
```

---

## 해결 방안

### 1. Binance API 사용 (단기)
```python
import ccxt
exchange = ccxt.binance()
# Binance는 since 파라미터 더 잘 지원
```

**장점:**
- 과거 데이터 접근 가능성 높음
- API 안정성 우수

**단점:**
- MEXC와 코인 목록 다름
- 실전과 완벽히 일치하지 않음

### 2. 데이터 수집 스크립트 (중기) ⭐ 권장
```python
# daily_data_collector.py
# 매일 실행하여 5분봉 데이터를 DB에 저장
# cron: 0 0 * * * python daily_data_collector.py
```

**장점:**
- 실전 MEXC 데이터 그대로 수집
- 장기간 누적 가능
- 백테스트 재현성 확보

**단점:**
- 지금 당장은 사용 불가
- 3~6개월 데이터 수집 필요

### 3. 상용 데이터 서비스 (장기)
- CryptoDataDownload
- Kaggle Datasets
- CoinAPI

**장점:**
- 과거 데이터 즉시 확보

**단점:**
- 비용
- MEXC 데이터 아닐 수 있음

---

## 실전 접근법

### 현재 (2026-02)
```bash
# 최근 2일 데이터로 엔진 검증
python run_backtest.py SCANNER 2026-02-12 2026-02-14 --cycles 6,12,24
```

**목적:** 
- 백테스트 엔진 검증 ✅
- 손절/익절 로직 확인 ✅
- 스캐너 모드 확인 ✅

### 3개월 후 (2026-05)
1. **실전 운영 데이터 수집**
   - bot이 매 사이클마다 진입/청산
   - 실제 PNL 기록
   - `history` 누적

2. **실전 데이터 분석**
   - 48h vs 72h vs 96h 승률 비교
   - 손절/익절 발동 빈도
   - 평균 수익률

3. **최적 주기 결정**
   - 실전 데이터 기반
   - 백테스트는 참고용

---

## 결론

**백테스트의 한계:**
- MEXC API로는 장기 백테스트 불가
- 최근 1~2일만 가능

**대안:**
- ✅ **실전 운영 3개월** (가장 정확)
- ⚙️ 데이터 수집 스크립트 구축
- 🔄 Binance API로 대략적 검증

**현재 상태:**
- 백테스트 엔진 검증 완료 ✅
- 손절/익절 로직 확인 완료 ✅
- 스캐너 모드 작동 확인 완료 ✅
- **실전 운영 준비 완료** 🚀

---

**작성일**: 2026-02-14  
**이슈**: MEXC API 데이터 제약  
**해결책**: 실전 운영 + 데이터 누적
